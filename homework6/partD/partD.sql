/ as sysdba

SELECT to_char(sysdate,'DD MM YYYY Year Month Day HH:MI:SS AM') FROM dual;

DROP USER c##lennin_L5Q1 CASCADE;
CREATE USER c##lennin_L5Q1 IDENTIFIED BY 123;
GRANT CONNECT, RESOURCE, DBA TO c##lennin_L5Q1;
ALTER USER c##lennin_L5Q1 QUOTA 100M on users;
CONNECT c##lennin_L5Q1/123;

SPOOL C:\Users\lenni\Escritorio\SPOOLD.txt

CREATE TABLE COURSE(
    CourseID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    CourseName VARCHAR2(10) NOT NULL,
    Credits NUMBER,
    CONSTRAINT CourseID_PK PRIMARY KEY (CourseID)
);

CREATE TABLE TERM(
    TermID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Descriptionn VARCHAR2(10) NOT NULL,
    Status VARCHAR2(10) CHECK (Status IN ('OPEN', 'CLOSED')),
    CONSTRAINT TermID_PK PRIMARY KEY (TermID)
);

CREATE TABLE LOCATION(
    LocID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Building VARCHAR2(10) NOT NULL,
    Room NUMBER UNIQUE,
    CONSTRAINT LocID_PK PRIMARY KEY (LocID)
);

CREATE TABLE STUDENT(
    StudID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    SName VARCHAR2(10) NOT NULL,
    Birthdate DATE,
    CONSTRAINT StudID_PK PRIMARY KEY (StudID)
);

CREATE TABLE COURSE_SECTION(
    CSectionID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    MaxCapacity NUMBER NOT NULL,
    CourseID NUMBER,
    TermID NUMBER,
    LocID NUMBER,
    CONSTRAINT CSectionID_PK PRIMARY KEY (CSectionID),
    CONSTRAINT CourseID_FK FOREIGN KEY (CourseID) REFERENCES COURSE (CourseID),
    CONSTRAINT TermID_FK FOREIGN KEY (TermID) REFERENCES TERM (TermID),
    CONSTRAINT LocID_FK FOREIGN KEY (LocID) REFERENCES LOCATION (LocID)
);


CREATE TABLE ENROLLMENT(
    StudID NUMBER,
    CSectionID NUMBER,
    GRADE NUMBER,
    CONSTRAINT StudID_FK FOREIGN KEY (StudID) REFERENCES STUDENT (StudID),
    CONSTRAINT CSectionID_FK FOREIGN KEY (CSectionID) REFERENCES COURSE_SECTION (CSectionID)
);



INSERT INTO COURSE (CourseID, CourseName, Credits) VALUES (1, 'Database', 3);

INSERT INTO LOCATION (LocID, Building,Room) VALUES (1, 'COCO', 5);

INSERT INTO TERM (TermID, Descriptionn, Status) VALUES (1, 'N/A', 'OPEN');

INSERT INTO STUDENT (StudID, SName, Birthdate) VALUES (1, 'LENNIN', sysdate+1);

INSERT INTO COURSE_SECTION (CSectionID, CourseID, TermID, LocID, MaxCapacity) 
VALUES (14, 1, 1, 1, 10);

INSERT INTO COURSE_SECTION (CSectionID, CourseID, TermID, LocID, MaxCapacity) 
VALUES (15, 1, 1, 1, 10);

INSERT INTO ENROLLMENT (StudID, CSectionID, GRADE) 
VALUES (1, 14, NULL);

INSERT INTO ENROLLMENT (StudID, CSectionID, GRADE) 
VALUES (1, 15, NULL);

UPDATE COURSE_SECTION SET MaxCapacity = 25 WHERE CSectionID = 15;


SPOOL OFF;
